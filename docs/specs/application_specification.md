# Donezo アプリケーション仕様書

## 概要

Donezoは、シンプルで使いやすいタスク管理アプリケーションです。ユーザーが日常のタスクを効率的に管理し、生産性を向上させることを目的としています。

## 対象ユーザー

- 日常的なタスクを効率的に管理したい個人
- シンプルで直感的なインターフェースを好むユーザー
- デジタルツールを使ってタスク管理を始めたい初心者
- 複雑な機能よりも基本的な機能を重視するユーザー

## 技術スタック

### バックエンド
- Ruby on Rails 8.0
- SQLite（開発環境）
- PostgreSQL（本番環境）
- Devise（ユーザー認証）
- Puma（Webサーバー）

### フロントエンド
- Hotwire（Turbo, Stimulus）
- Tailwind CSS
- Font Awesome（アイコン）
- Importmap（JavaScriptモジュール管理）

### 開発ツール
- Minitest（テスティングフレームワーク）
- Capybara（システムテスト）
- RuboCop（コード品質チェック）

## 機能仕様

### 1. ユーザー管理

#### 1.1 ユーザー登録
- ユーザーはメールアドレスとパスワードで登録可能
- Deviseを使用した標準的な認証フロー

#### 1.2 ユーザーログイン/ログアウト
- 登録済みユーザーはメールアドレスとパスワードでログイン可能
- セッション管理によるログイン状態の維持
- ログアウト機能

#### 1.3 パスワードリセット
- パスワードを忘れた場合のリセット機能

### 2. タスク管理

#### 2.1 タスク一覧表示
- ユーザーごとのタスク一覧表示
- 作成日時の降順で表示
- タスクの状態（完了/未完了、実行中/停止中）が視覚的に区別可能

#### 2.2 タスク作成
- タイトルを入力して新規タスクを作成
- Turbo Streamを使用した非同期作成（ページ遷移なし）

#### 2.3 タスク完了/未完了の切り替え
- チェックボックスによるタスク完了状態の切り替え
- Stimulus Controllerを使用した非同期更新

#### 2.4 タスク削除
- 不要になったタスクの削除機能
- 削除確認なしで即時削除

#### 2.5 タスクの実行管理
- タスクを「実行中」状態に設定可能
- 一度に1つのタスクのみ実行中にできる（他の実行中タスクは自動的に停止）
- 実行中タスクの経過時間をリアルタイムで表示
- タスクの停止機能（経過時間は保存）

#### 2.6 タスクフォーカスモード
- 特定のタスクに集中するためのフォーカスビュー
- 大きなタイマー表示
- タスク操作（開始/停止/完了/削除）のボタン
- 次のタスク表示（ある場合）

### 3. UI/UX

#### 3.1 レスポンシブデザイン
- モバイル、タブレット、デスクトップに対応したレイアウト
- Tailwind CSSによるユーティリティファーストのスタイリング

#### 3.2 インタラクティブUI
- Hotwire（TurboとStimulus）を使用した高速なインタラクション
- ページ遷移なしでのコンテンツ更新
- リアルタイムタイマー表示

#### 3.3 視覚的フィードバック
- タスク完了時の視覚的フィードバック（取り消し線、色変更）
- 実行中タスクのアニメーション表示（パルス効果）

## データモデル

### User（ユーザー）
- email: string - ユーザーのメールアドレス
- password: string - 暗号化されたパスワード
- その他Deviseによる認証関連フィールド
- has_many :tasks - タスクとの関連付け

### Task（タスク）
- title: string - タスクのタイトル
- completed: boolean - タスクの完了状態
- in_progress: boolean - タスクの実行状態
- started_at: datetime - タスク開始時刻
- elapsed_time: integer - 累積経過時間（秒）
- user_id: integer - 所有ユーザーへの参照
- belongs_to :user - ユーザーとの関連付け

## 主要なメソッド

### Task
- `start_task()`: タスクを実行中にする（他の実行中タスクは停止）
- `stop_task()`: タスクを停止し、経過時間を更新
- `complete_task()`: タスクを完了状態にする
- `reset_task()`: タスクをリセットする
- `formatted_elapsed_time()`: 経過時間を人間が読める形式で返す

## コントローラー

### TasksController
- `index`: ユーザーのタスク一覧を表示
- `create`: 新規タスクを作成
- `update`: タスクを更新（完了状態など）
- `destroy`: タスクを削除

### TaskStatesController
- `update`: タスクの状態を更新（実行中/停止/完了）

### TaskFocusesController
- `show`: タスクのフォーカスビューを表示

## JavaScript（Stimulus）コントローラー

### TaskController
- タスクの完了状態の切り替え処理
- タスクフォームの送信処理

### TimerController
- タスクの経過時間のリアルタイム表示
- タイマーの開始/停止/更新処理

## 現在の状態と今後の展望

### 完了している機能
- ユーザー認証（サインアップ、ログイン、ログアウト）
- タスクの作成
- タスクの表示（ユーザーごと）
- タスクの完了状態の切り替え
- タスクの削除
- タスクの実行管理（開始/停止）
- タスクフォーカスモード
- レスポンシブデザイン
- Turbo Framesによる部分更新
- Stimulus Controllersによるインタラクティブな操作

### 今後の展望
- タスクのソート機能
- タスクのフィルタリング
- タスクの編集機能
- タスクのカテゴリ分け
- タスクの優先度設定
- 期限設定機能
- チーム共有機能
- リマインダー機能
- モバイルアプリ対応

## 既知の課題

- タスクが多数ある場合のパフォーマンス問題
- テストカバレッジの不足
- モバイル対応の最適化
- 一部のアクションでのユーザーフィードバックの不足
- アクセシビリティの問題

## 開発方針

- テスト駆動開発（TDD）を採用
- シンプルで直感的なUIデザイン
- レスポンシブデザインによるマルチデバイス対応
- パフォーマンスとセキュリティの最適化
